(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     49598,        998]
NotebookOptionsPosition[     48007,        950]
NotebookOutlinePosition[     48684,        973]
CellTagsIndexPosition[     48641,        970]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["ElectricFuelCellL1", "Title",
 CellChangeTimes->{{3.520873834546875*^9, 3.520873840984375*^9}, {
   3.520880951484375*^9, 3.520880952703125*^9}, 3.5353435216307597`*^9, {
   3.8139995919011564`*^9, 3.8139995974917917`*^9}},
 ExpressionUUID -> "57b21790-662b-4ee4-8918-fd00c687c174"],

Cell["\<\
This is a dynamic model of a fuel cell. The model is based on basic models in \
literature. It is a Level 1 model. I.e it is useful to represent a fuel cell \
in system. It can be parameterized to yield adequate accuracy to represent a \
fuel cell in a system, particularly for conceptual design. The model contains \
some dynamics.

References

1. Radmanesh, H., Heidari Yazdi, S. S., Gharehpetian, G. B. & Fathi, S. H. \
Modelling and simulation of fuel cell dynamics for electrical energy usage of \
Hercules airplanes. Sci. World J. 2014, (2014).
2. Thanapalan, K. K. T., Williams, J. G., Liu, G. P. & Rees, D. Modelling of \
a Pem Fuel Cell System. IFAC Proceedings Volumes 41, (IFAC, 2008).
3. Boccaletti, C., Duni, G., Fabbri, G. & Santini, E. Simulation models of \
fuel cell systems. Proc. ICEM, Electr. Mach. Chania, Greece 6 (2006). \
doi:10.1111/j.1743-6109.2008.01122.x.Endothelial\
\>", "Text",
 CellChangeTimes->{{3.8139996015276814`*^9, 3.8139999157836046`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"<<", "C:\\\\Hopsan\\Compgen\\CompgenNG.mx"}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.525533906765625*^9, 3.525533914734375*^9}, 
   3.577601924150117*^9, 3.753532820170209*^9, 3.753532868377143*^9, 
   3.762728078322752*^9},
 ExpressionUUID -> "fb626f91-feab-4a07-b722-dbbcc151c4cc"],

Cell[BoxData[
 RowBox[{"path", "=", 
  RowBox[{"ToFileName", "[", 
   RowBox[{"{", 
    RowBox[{
    "\"\<C:\>\"", ",", "\"\<Users\>\"", ",", "\"\<petkr14\>\"", ",", 
     "\"\<Dropbox\>\"", ",", "\"\<HopsanComponents\>\"", ",", 
     "\"\<AeroComponents\>\"", ",", "\"\<Aero\>\""}], "}"}], "]"}]}]], "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.},
 CellChangeTimes->{{3.754985113560959*^9, 3.754985114033472*^9}, {
   3.757063485852047*^9, 3.757063485995899*^9}, 3.76272807832475*^9, {
   3.7747826878685503`*^9, 3.774782689771587*^9}, {3.774797375685176*^9, 
   3.7747973875893726`*^9}, {3.7760688172187753`*^9, 
   3.7760688264662404`*^9}, {3.7760688832017593`*^9, 
   3.7760688836492944`*^9}, {3.7846317812093024`*^9, 3.784631800055241*^9}, {
   3.790939336655615*^9, 3.790939344120914*^9}, {3.7994934461032467`*^9, 
   3.7994934538013234`*^9}, {3.79974100026252*^9, 3.799741026886066*^9}, 
   3.812283771905965*^9, {3.812283878750459*^9, 3.812283970057192*^9}, 
   3.812433433933036*^9, 3.812434085221577*^9, {3.8124344329826465`*^9, 
   3.812434438238638*^9}, {3.8124370537370176`*^9, 3.812437056984214*^9}, {
   3.8124371450929265`*^9, 3.812437172519957*^9}},
 ExpressionUUID -> "87099fba-26b4-4a14-8efc-4913b3525ac8"]
}, Open  ]],

Cell[BoxData["\<\"C:\\\\Users\\\\petkr14\\\\Dropbox\\\\HopsanComponents\\\\\
AeroComponents\\\\Aero\\\\\"\>"], "Output",
 CellChangeTimes->{
  3.812437062071355*^9, 3.8124371869143744`*^9, 3.8124446205953465`*^9, 
   3.812445622220993*^9, 3.8124458763042235`*^9, 3.812446015183985*^9, 
   3.812446089889885*^9, 3.8124462504045706`*^9, 3.812446471667842*^9, 
   3.812446603080182*^9, 3.812446645072215*^9, 3.8124492998011446`*^9, 
   3.8124493663940754`*^9, 3.8124504175374737`*^9, 3.8124505279089117`*^9, 
   3.8124507362629805`*^9, 3.8124508129886093`*^9, 3.81245193203526*^9, 
   3.8124521938361197`*^9, 3.812452275295189*^9, 3.8124523983292313`*^9, 
   3.8128044394133687`*^9, 3.8128045773483257`*^9, 3.8128048063658524`*^9, 
   3.8128055603855534`*^9, 3.8128056953342667`*^9, 3.8128058013773336`*^9, 
   3.8128059917785306`*^9, 3.81280624244522*^9, 3.812806299114996*^9, 
   3.8128080652806826`*^9, 3.812808188696411*^9, 3.8128082793498816`*^9, {
   3.812808323063326*^9, 3.812808348340244*^9}, 3.8128087515385895`*^9, 
   3.8128092757390594`*^9, 3.8133195244119005`*^9, 3.813321931894185*^9, 
   3.813321967418949*^9, 3.813322802081803*^9, 3.8133248619321733`*^9, 
   3.813325079940005*^9, {3.8133256344623823`*^9, 3.8133256474776974`*^9}, 
   3.8133272857414637`*^9, 3.8133274608995295`*^9, 3.8133893463183327`*^9, 
   3.8133895038131943`*^9, 3.813389590775037*^9, 3.813389714102804*^9, 
   3.813390947998685*^9, 3.813391082268714*^9, 3.8133911885791993`*^9, 
   3.8133930009292526`*^9, 3.813393195860009*^9, 3.8133935691586657`*^9, 
   3.8133962016903963`*^9, 3.813396486922597*^9, 3.8133966975192637`*^9, 
   3.8133967847077136`*^9, 3.8133969573110533`*^9, 3.8133971055099583`*^9, 
   3.8133978151946864`*^9, 3.813398834768599*^9, 3.813399335678241*^9, 
   3.8133994202058744`*^9, 3.8133998414318485`*^9, 3.8134001477980976`*^9, 
   3.813491389643916*^9, 3.813495100083356*^9, 3.8134952091770253`*^9, 
   3.8134952991874313`*^9, 3.8134954049455004`*^9, 3.813495497123536*^9, 
   3.8134956973980303`*^9, 3.8134958555177426`*^9, 3.8134959526882725`*^9, 
   3.813668274527954*^9, 3.813668419909424*^9, 3.813668486810704*^9, 
   3.8136685493518295`*^9, 3.8136686546922407`*^9, 3.8136703382998457`*^9, 
   3.8136724327106695`*^9, 3.813672542437233*^9},
 ExpressionUUID -> "39246cf4-dbd6-45be-8b20-65b0c8b0d003"],

Cell[BoxData[
 RowBox[{"Off", "[", 
  RowBox[{"General", "::", "\"\<spell1\>\""}], "]"}]], "Input",
 PageWidth:>WindowWidth,
 ExpressionUUID -> "652a0152-5a14-4b79-b70d-d9fa36510144"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"domain", "=", "\"\<Electric\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"displayName", "=", "\"\<FuelCellL1\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{
  "brief", "=", 
   "\"\<Level 1 (conceptual) Fuel cell model with some dynamics\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"componentType", "=", "\"\<ComponentQ\>\""}], ";"}], "\n", 
 RowBox[{
  RowBox[{"author", "=", "\"\<Petter Krus <petter.krus@liu.se>\>\""}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
  "affiliation", " ", "=", " ", 
   "\"\<Division of Fluid and Mechatronic Systems, Link\[ODoubleDot]ping \
University\>\""}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetFilenames", "[", 
   RowBox[{"path", ",", "domain", ",", "displayName"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ResetComponentVariables", "[", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.520880152296875*^9, 3.520880230078125*^9}, 
   3.520932125875*^9, 3.520932753984375*^9, {3.52093324790625*^9, 
   3.520933251453125*^9}, {3.521775289609375*^9, 3.521775289921875*^9}, {
   3.52249560790625*^9, 3.522495611953125*^9}, {3.5353435506144285`*^9, 
   3.5353435625103617`*^9}, {3.538982066538947*^9, 3.5389820811170716`*^9}, {
   3.538982378538947*^9, 3.538982399913947*^9}, {3.540095811916009*^9, 
   3.5400958134316144`*^9}, {3.5400958446187153`*^9, 
   3.5400958611341286`*^9}, {3.7994929462982273`*^9, 3.79949294812035*^9}, 
   3.799493326163699*^9, {3.7997722672221565`*^9, 3.799772286280518*^9}, {
   3.7997723174983525`*^9, 3.799772319009794*^9}, {3.8000104740765705`*^9, 
   3.8000105130094523`*^9}, 3.8000732267354856`*^9, {3.8124334857733374`*^9, 
   3.8124334933629923`*^9}},
 ExpressionUUID -> "aa43e10d-c05d-43e3-a087-d1ec17470b5d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inputVariables", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"{", 
     RowBox[{
     "thetaFcRef", ",", "1.", ",", "double", ",", "\"\<\>\"", ",", 
      "\"\<Power fraction reference [0,1]\>\""}], "}"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.446223460296875*^9, 3.44622356096875*^9}, {
   3.4462236030625*^9, 3.446223670484375*^9}, {3.446223703640625*^9, 
   3.4462238429375*^9}, {3.4462265591875*^9, 3.44622670078125*^9}, {
   3.4463566622546744`*^9, 3.4463566920669837`*^9}, 3.4463567240041475`*^9, {
   3.446357070530962*^9, 3.446357073718421*^9}, 3.446379656956832*^9, {
   3.4464008796202064`*^9, 3.44640090863546*^9}, {3.446452519793661*^9, 
   3.446452619136775*^9}, {3.446460814522464*^9, 3.446460921949324*^9}, {
   3.446460972761937*^9, 3.4464609779947715`*^9}, {3.446461042663227*^9, 
   3.4464610541442213`*^9}, {3.446522488390625*^9, 3.446522516109375*^9}, {
   3.446522610078125*^9, 3.446522622265625*^9}, {3.44652284971875*^9, 
   3.446522850484375*^9}, 3.446524524569768*^9, {3.44657946146875*^9, 
   3.44657946196875*^9}, {3.446637579390625*^9, 3.446637622890625*^9}, {
   3.44663767678125*^9, 3.446637762140625*^9}, {3.446741156203125*^9, 
   3.446741194671875*^9}, 3.446744375703125*^9, {3.4468319421875*^9, 
   3.446831994875*^9}, {3.447609315015625*^9, 3.447609356953125*^9}, 
   3.44760944415625*^9, {3.447938433375*^9, 3.44793848459375*^9}, {
   3.447938571546875*^9, 3.4479385744375*^9}, {3.447951560046875*^9, 
   3.44795160009375*^9}, {3.457505934953125*^9, 3.457505949234375*^9}, {
   3.540095890602502*^9, 3.540095891883735*^9}, {3.800013706988228*^9, 
   3.8000137263942327`*^9}, {3.800082537647973*^9, 3.800082542135347*^9}, {
   3.800090224922123*^9, 3.8000902659348636`*^9}},
 ExpressionUUID -> "5248b079-d643-4e8a-986c-34efe7ba874e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"inputParameters", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "R", ",", "4124.2", ",", "double", ",", "\"\<J/Kg K\>\"", ",", 
       "\"\<Gas constant\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "cv", ",", "10183.", ",", "double", ",", "\"\<J/Kg K\>\"", ",", 
       "\"\<heatcoeff\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "kmFC", ",", "1000.", ",", "double", ",", "\"\<W/kg\>\"", ",", 
       "\"\<Fuel cell spec. power\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "nstack", ",", "1", ",", "double", ",", "\"\<\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "T", ",", "323", ",", "double", ",", "\"\<K\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Tref", ",", "298.15", ",", "double", ",", "\"\<K\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"A", ",", 
       RowBox[{"62.5", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", "double", ",", "\"\<m2\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"l", ",", 
       RowBox[{"25", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "6"}]]}], ",", "double", ",", "\"\<m\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Ph2", ",", "1.476", ",", "double", ",", "\"\<atm\>\"", ",", 
       "\"\<Hydrogen partial press\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Po2", ",", "0.2095", ",", "double", ",", "\"\<atm\>\"", ",", 
       "\"\<Oxygen partial press\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "P0", ",", "1", ",", "double", ",", "\"\<atm\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Faraday", ",", "96485.3", ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"dS", ",", 
       RowBox[{".85", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]], "2", " ", "96485.3"}], ",", "double", ",", 
       "\"\<\>\"", ",", "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "dG", ",", "228000.6", ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<Gibbs free energy\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "B", ",", "0.15", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Rc", ",", "0.0003", ",", "double", ",", "\"\<\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Ch2", ",", "0.2", ",", "double", ",", "\"\<\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ksi1", ",", 
       RowBox[{"-", ".948"}], ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ksi3", ",", 
       RowBox[{"7.22", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]]}], ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"ksi4", ",", 
       RowBox[{
        RowBox[{"-", "1.064"}], " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "4"}]]}], ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "psi", ",", "23.", ",", "double", ",", "\"\<\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Jmax", ",", 
       RowBox[{"672.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]], 
        SuperscriptBox["10", "4"]}], ",", "double", ",", "\"\<A/m2\>\"", ",", 
       "\"\<Max current intensity\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"Jn", ",", 
       RowBox[{"22.", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]], 
        SuperscriptBox["10", "4"]}], ",", "double", ",", "\"\<A/m2\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"MH2", ",", 
       RowBox[{"2.016", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "3"}]]}], ",", "double", ",", "\"\<kg/mol\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "cA", ",", "10.", ",", "double", ",", "\"\<F\>\"", ",", 
       "\"\<Capacitance\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "conNum", ",", "1000.", ",", "double", ",", "\"\<1/Ohm\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "thaucon", ",", ".1", ",", "double", ",", "\"\<s\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "timeComp", ",", "1.", ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<time compression factor.\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"e", ",", 
       RowBox[{"N", "[", 
        RowBox[{"E", ",", "6"}], "]"}], ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<e\>\""}], "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.446223415796875*^9, 3.44622341625*^9}, {
   3.446226723234375*^9, 3.446226798453125*^9}, {3.446522549734375*^9, 
   3.4465225531875*^9}, {3.44652258853125*^9, 3.44652273034375*^9}, 
   3.44652281059375*^9, {3.446621606296875*^9, 3.446621667125*^9}, {
   3.446621712171875*^9, 3.446621755359375*^9}, 3.446621793125*^9, {
   3.446741206*^9, 3.4467412113125*^9}, 3.446744380671875*^9, {
   3.4468318606875*^9, 3.446831875703125*^9}, {3.447343772046875*^9, 
   3.44734378671875*^9}, {3.447609447859375*^9, 3.447609485359375*^9}, {
   3.44793849353125*^9, 3.4479386746875*^9}, {3.44794802734375*^9, 
   3.44794807459375*^9}, {3.447948734828125*^9, 3.44794874171875*^9}, {
   3.4480035023598375`*^9, 3.4480035087661285`*^9}, {3.45754899871875*^9, 
   3.457549000296875*^9}, {3.540095892274355*^9, 3.540095893149344*^9}, {
   3.5400959381018934`*^9, 3.5400959624297075`*^9}, {3.7994934149283323`*^9, 
   3.799493418070098*^9}, {3.799496646533085*^9, 3.799496646955649*^9}, {
   3.7995529291721597`*^9, 3.7995529613860025`*^9}, {3.7995564052598886`*^9, 
   3.799556405945182*^9}, {3.799557214041218*^9, 3.799557215609604*^9}, {
   3.7995633570572805`*^9, 3.7995634141585097`*^9}, {3.7995634587685895`*^9, 
   3.7995634620382247`*^9}, {3.7995635356654415`*^9, 3.799563538341689*^9}, 
   3.799563578515335*^9, {3.799572785499095*^9, 3.7995727943519816`*^9}, 
   3.7995731961698985`*^9, {3.8000107839762473`*^9, 3.8000108427566795`*^9}, {
   3.8000111135926113`*^9, 3.800011236989462*^9}, {3.8000112719923944`*^9, 
   3.800011274996299*^9}, {3.8000125973077617`*^9, 3.8000126118387895`*^9}, {
   3.8000126481403837`*^9, 3.8000127007541695`*^9}, {3.8000128012366343`*^9, 
   3.8000128086619844`*^9}, {3.8000129052674427`*^9, 
   3.8000129063453283`*^9}, {3.800013170596927*^9, 3.8000131959547987`*^9}, {
   3.8000133200289545`*^9, 3.8000133460861025`*^9}, {3.800013568072367*^9, 
   3.800013591122617*^9}, {3.8000136232684927`*^9, 3.800013652237646*^9}, {
   3.8000143380701475`*^9, 3.800014365634742*^9}, 3.8000144452866726`*^9, {
   3.8000145190596533`*^9, 3.800014527543912*^9}, {3.800014599901352*^9, 
   3.800014600509725*^9}, 3.8000732611086636`*^9, 3.800073419123235*^9, {
   3.800082700285392*^9, 3.8000827345400925`*^9}, {3.800083139424898*^9, 
   3.8000831617748685`*^9}, {3.800090137506197*^9, 3.8000902159893274`*^9}, 
   3.8000906296091337`*^9, {3.80009645709447*^9, 3.8000964803325253`*^9}, 
   3.800098310288556*^9, {3.8001037106959558`*^9, 3.800103731234792*^9}, {
   3.807965650676302*^9, 3.807965923451647*^9}, {3.8079661195094023`*^9, 
   3.80796622038535*^9}, {3.8079663827993393`*^9, 3.807966391412004*^9}, {
   3.8079664336280565`*^9, 3.807966475608269*^9}, {3.812282652243433*^9, 
   3.812282791534547*^9}, {3.8124452761090975`*^9, 3.812445287266114*^9}, {
   3.8124461990390387`*^9, 3.8124462414798985`*^9}, {3.812446636563357*^9, 
   3.812446639619002*^9}, {3.812450197113067*^9, 3.812450237154541*^9}, {
   3.8124502844007425`*^9, 3.812450287777931*^9}, {3.8124503298777885`*^9, 
   3.8124503985000753`*^9}, {3.812450485305642*^9, 3.8124505141123753`*^9}, {
   3.81245058232337*^9, 3.812450600172552*^9}, {3.8124506386460366`*^9, 
   3.812450655417533*^9}, {3.8124516421544495`*^9, 3.8124516423002806`*^9}, 
   3.8124518729893155`*^9, {3.8124522497556977`*^9, 3.8124522557799516`*^9}, 
   3.8124527306602154`*^9, 3.812452844267065*^9, {3.812793055891593*^9, 
   3.812793056606962*^9}, {3.8127930894205613`*^9, 3.812793096039071*^9}, {
   3.812796953928521*^9, 3.81279699842358*^9}, 3.812804571502385*^9, {
   3.8128056803922567`*^9, 3.812805687808037*^9}, {3.8128080316310773`*^9, 
   3.8128080488631887`*^9}, {3.8133908471387835`*^9, 3.8133908541717615`*^9}, 
   3.813390889206024*^9, 3.8133911803820834`*^9, {3.8133929274064655`*^9, 
   3.8133929475132976`*^9}, {3.813393397902934*^9, 3.8133934802105565`*^9}, {
   3.8133935235957847`*^9, 3.8133935397880135`*^9}, {3.8133975575796547`*^9, 
   3.8133976129994*^9}, 3.8134970146796255`*^9, {3.8136679579006453`*^9, 
   3.813668012500763*^9}, {3.813668069016296*^9, 3.8136680727881365`*^9}, {
   3.8136717294295654`*^9, 3.8136717433100758`*^9}, {3.813672349420684*^9, 
   3.813672382738653*^9}, {3.813674228632859*^9, 3.813674279815218*^9}, {
   3.8139924164231243`*^9, 3.813992418380746*^9}, {3.813992461334635*^9, 
   3.8139924656447215`*^9}, 3.813998965717907*^9, {3.8139994392864437`*^9, 
   3.81399944010127*^9}},
 ExpressionUUID -> "a8051811-30d3-4363-a9c0-96a8c6911042"],

Cell[BoxData[
 RowBox[{
  RowBox[{"outputVariables", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "mFC", ",", "1.", ",", "double", ",", "\"\<kg\>\"", ",", 
       "\"\<Mass of fuel cell\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "unernst", ",", "1.", ",", "double", ",", "\"\<V\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "uOhmic", ",", "1", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "uact", ",", "1", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ucon", ",", "1", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ufc0", ",", "1", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ufcr", ",", "1", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ufc1", ",", "1", ",", "double", ",", "\"\<V\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "ifc0", ",", "0.", ",", "double", ",", "\"\<A\>\"", ",", "\"\<\>\""}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "etaFC", ",", "0.", ",", "double", ",", "\"\<\>\"", ",", 
       "\"\<Fuel cell efficiency\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "Powfc", ",", "0.", ",", "double", ",", "\"\<Power\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "rhoM", ",", "0.", ",", "double", ",", "\"\<kg/m^3\>\"", ",", 
       "\"\<\>\""}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
      "WH2", ",", "0.", ",", "double", ",", "\"\<kg/s\>\"", ",", "\"\<\>\""}],
       "}"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.446223415796875*^9, 3.44622341625*^9}, {
   3.446226723234375*^9, 3.446226798453125*^9}, {3.446522549734375*^9, 
   3.4465225531875*^9}, {3.44652258853125*^9, 3.44652273034375*^9}, 
   3.44652281059375*^9, {3.446621606296875*^9, 3.446621667125*^9}, {
   3.446621712171875*^9, 3.446621755359375*^9}, 3.446621793125*^9, {
   3.446741206*^9, 3.4467412113125*^9}, 3.446744380671875*^9, {
   3.4468318606875*^9, 3.446831875703125*^9}, {3.447343772046875*^9, 
   3.44734378671875*^9}, {3.447609447859375*^9, 3.447609485359375*^9}, {
   3.44793849353125*^9, 3.447938517765625*^9}, {3.447938690859375*^9, 
   3.447938742890625*^9}, 3.447948745546875*^9, {3.4575059564375*^9, 
   3.457505973640625*^9}, 3.4575489668125*^9, 3.457549249203125*^9, {
   3.5400958936805873`*^9, 3.5400958945243263`*^9}, {3.799554175099737*^9, 
   3.7995541854331026`*^9}, {3.7995553197082367`*^9, 3.799555324427379*^9}, 
   3.7995563687105074`*^9, {3.799556421980677*^9, 3.7995564222294207`*^9}, {
   3.799557134241356*^9, 3.7995571646320744`*^9}, {3.7995634963179407`*^9, 
   3.799563591780681*^9}, {3.8000016237027655`*^9, 3.8000017189501467`*^9}, 
   3.800010763130728*^9, {3.800013206082363*^9, 3.8000132070233955`*^9}, {
   3.8079668645968237`*^9, 3.8079668667813263`*^9}, {3.812283169102991*^9, 
   3.812283215640701*^9}, {3.812283421756698*^9, 3.8122834428796144`*^9}, {
   3.8124442623130283`*^9, 3.81244430090656*^9}, {3.8124464425395265`*^9, 
   3.812446460820372*^9}, {3.8124493481350117`*^9, 3.812449348258851*^9}, 
   3.812450404940544*^9, {3.8124518808992877`*^9, 3.8124519004948463`*^9}, {
   3.8124542119570932`*^9, 3.812454234409788*^9}, {3.8127929990681114`*^9, 
   3.812793004788305*^9}, {3.812796899419376*^9, 3.8127969225571785`*^9}, 
   3.812804768232119*^9, {3.8128049497183475`*^9, 3.8128049506108804`*^9}, {
   3.812807989529801*^9, 3.8128079932183332`*^9}, {3.8133224251311903`*^9, 
   3.813322439552454*^9}, {3.8133226798755193`*^9, 3.813322687450982*^9}, {
   3.8133245893813124`*^9, 3.813324606797473*^9}, {3.813324849681181*^9, 
   3.8133248544814396`*^9}, {3.813390826199456*^9, 3.81339084203371*^9}, 
   3.8133929600442677`*^9, {3.8133977849865017`*^9, 3.813397785699095*^9}, {
   3.8134001384380584`*^9, 3.8134001428199453`*^9}, {3.8136679154858913`*^9, 
   3.813667941244155*^9}, {3.8136741695850163`*^9, 
   3.813674191786313*^9}},ExpressionUUID->"95bbac0c-8418-4ac4-ad04-\
338ca530aad6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nodeConnections", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ElectricQnode", "[", 
      RowBox[{"fc", ",", "0.", ",", "\"\<Port\>\""}], "]"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PneumaticQnode", "[", 
      RowBox[{"p1", ",", "100000.", ",", "\"\<fluid port 1\>\""}], "]"}]}], 
    "\[IndentingNewLine]", "\t\t\t", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.800002485882186*^9, 3.80000249080711*^9}, 
   3.8079668758938937`*^9, {3.812281330424515*^9, 3.812281330524491*^9}, 
   3.8136701594350414`*^9},
 ExpressionUUID -> "dcb3ed7f-04e8-4f15-8348-07de34c3b386"],

Cell[BoxData[
 RowBox[{
  RowBox[{"LogA1", "[", "x_", "]"}], ":=", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"1.3", " ", "x"}], 
    RowBox[{"1", "-", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"0.93", "x"}], ")"}], "4"]}]]}]}]], "Input",
 CellChangeTimes->{{3.813396687458029*^9, 3.81339669137978*^9}},
 ExpressionUUID -> "86215f11-466e-4aaf-a4ae-6719aa5eabf6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"IfPositive", "=."}], ";"}]], "Input",
 CellChangeTimes->{{3.8079584490650654`*^9, 3.80795845007049*^9}},
 ExpressionUUID -> "81de4ce8-1527-421a-8d0a-45bef57344ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"J", "=", 
   RowBox[{"ifc", "/", "A"}]}], ";"}]], "Input",
 CellChangeTimes->{3.8127928973477716`*^9, 3.8127929663903465`*^9},
 ExpressionUUID -> "68e75555-f4c6-46e2-8833-cf405ae99e7b"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.8140023147342405`*^9, 3.8140023347868347`*^9}}],

Cell["\<\
In the literature cm is usually used as the length scale. Here SI units are \
used which means that a factor 10^2 is sometimes used to compensate for this.\
\>", "Text",
 CellChangeTimes->{{3.8139996015276814`*^9, 3.8139999157836046`*^9}, {
  3.814002338310876*^9, 3.814002378715205*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"localExpressions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"cp", "\[Equal]", 
      RowBox[{"R", "+", "cv"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Co2", "==", 
      FractionBox["Po2", 
       RowBox[{"5.08", " ", 
        SuperscriptBox["10", "6"], 
        SuperscriptBox["e", 
         FractionBox[
          RowBox[{"-", "498"}], "T"]]}]]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ksi2", "==", 
      RowBox[{"0.00286", "+", 
       RowBox[{"0.0002", " ", 
        RowBox[{"Log", "[", 
         RowBox[{"A", " ", 
          SuperscriptBox["10", "4"]}], "]"}]}], "+", 
       RowBox[{"4.3", " ", 
        SuperscriptBox["10", 
         RowBox[{"-", "5"}]], 
        RowBox[{"Log", "[", "Ch2", "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"rhoM", "==", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"181.6", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"0.03", 
            RowBox[{"(", 
             FractionBox["ifc0", 
              RowBox[{"A", " ", 
               SuperscriptBox["10", "4"]}]], ")"}]}], "+", 
           RowBox[{"0.062", 
            SuperscriptBox[
             RowBox[{"(", 
              FractionBox["T", "303"], ")"}], "2"], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"lowLimit", "[", 
               RowBox[{
                FractionBox["ifc0", 
                 RowBox[{"A", " ", 
                  SuperscriptBox["10", "4"]}]], ",", "0."}], "]"}], ")"}], 
             "2.5"]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"psi", "-", "0.634", "-", 
         RowBox[{"3", 
          RowBox[{"(", 
           FractionBox["ifc0", 
            RowBox[{"A", " ", 
             SuperscriptBox["10", "4"]}]], ")"}], 
          SuperscriptBox["e", 
           RowBox[{"4.18", 
            RowBox[{"(", 
             FractionBox[
              RowBox[{"T", "-", "303"}], "T"], ")"}]}]]}]}], ")"}]}]}], ",", 
     RowBox[{"unernst", "==", 
      RowBox[{
       FractionBox["dG", 
        RowBox[{"2", " ", "Faraday"}]], "+", 
       RowBox[{
        FractionBox["dS", 
         RowBox[{"2", " ", "Faraday"}]], 
        RowBox[{"(", 
         RowBox[{"T", "-", "Tref"}], ")"}]}], "+", 
       RowBox[{
        FractionBox[
         RowBox[{"R", " ", "T"}], 
         RowBox[{"2", " ", "Faraday"}]], 
        RowBox[{"Log", "[", 
         FractionBox[
          RowBox[{"Ph2", " ", 
           SqrtBox["Po2"]}], 
          RowBox[{" ", "P0"}]], "]"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"uact", "\[Equal]", 
      RowBox[{"lowLimit", "[", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"ksi1", "+", 
           RowBox[{"ksi2", " ", "T"}], " ", "+", " ", 
           RowBox[{"ksi3", " ", "T", " ", 
            RowBox[{"Log", "[", "Co2", "]"}]}], "+", 
           RowBox[{"ksi4", " ", "T", " ", 
            RowBox[{"Log", "[", 
             RowBox[{"lowLimit", "[", 
              RowBox[{"ifc0", ",", 
               RowBox[{"1.", "*", 
                SuperscriptBox["10", 
                 RowBox[{"-", "30"}]]}]}], "]"}], "]"}]}]}], ")"}]}], ",", 
        "0"}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ucon", "\[Equal]", 
      RowBox[{
       RowBox[{"-", "B"}], " ", 
       RowBox[{"LogA1", "[", 
        RowBox[{"limit", "[", 
         RowBox[{
          FractionBox["J", "Jmax"], ",", "0.", ",", "1.075"}], "]"}], 
        "]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"uOhmic", "==", 
      RowBox[{
       FractionBox[
        RowBox[{"rhoM", " ", "l", " ", 
         SuperscriptBox["10", "2"]}], 
        RowBox[{"A", " ", 
         SuperscriptBox["10", "4"]}]], "ifc"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ufcr", "\[Equal]", 
      RowBox[{"lowLimit", "[", 
       RowBox[{
        RowBox[{"unernst", "-", "uact", "-", "ucon", "-", "uOhmic"}], ",", 
        "0."}], "]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"ufc0", "\[Equal]", 
      RowBox[{"lowLimit", "[", 
       RowBox[{
        RowBox[{"unernst", "-", "uact", "-", "ucon", "-", "uOhmic", "+", 
         RowBox[{"ifc0", "/", "conNum"}]}], ",", "0."}], "]"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.8079590903526983`*^9, 3.807959109587672*^9}, {
   3.8079591468632336`*^9, 3.8079591753861866`*^9}, {3.807963838575162*^9, 
   3.8079638390849037`*^9}, 3.8122828285448647`*^9, {3.8124453645765905`*^9, 
   3.8124453683872104`*^9}, {3.8124460767803907`*^9, 3.812446080369156*^9}, {
   3.8124501304770837`*^9, 3.812450131395052*^9}, {3.812450251328573*^9, 
   3.8124502603609295`*^9}, {3.81245153103395*^9, 3.8124515439178467`*^9}, {
   3.8124515968623266`*^9, 3.812451612817854*^9}, {3.812451652663537*^9, 
   3.812451697974645*^9}, {3.8124517338172684`*^9, 3.8124518399635143`*^9}, {
   3.8124523884774933`*^9, 3.8124523924112406`*^9}, {3.8127923334061193`*^9, 
   3.8127923887194414`*^9}, {3.8127926892429824`*^9, 
   3.8127927023279996`*^9}, {3.8127929058619747`*^9, 3.812792919237355*^9}, 
   3.8127930405402093`*^9, {3.8127931105555415`*^9, 3.8127931111627836`*^9}, {
   3.812796825781825*^9, 3.8127968773862877`*^9}, {3.81280477322359*^9, 
   3.812804781520046*^9}, {3.8128053523796782`*^9, 3.8128055517629147`*^9}, {
   3.812805665503106*^9, 3.8128056702524366`*^9}, 3.812805794047871*^9, {
   3.8128059217062793`*^9, 3.8128059786102247`*^9}, {3.812806181826959*^9, 
   3.812806221328786*^9}, 3.8128062930964413`*^9, 3.8128078758048267`*^9, {
   3.8128121500567164`*^9, 3.8128121617004724`*^9}, {3.8128122303672934`*^9, 
   3.8128123031867485`*^9}, {3.8128123351285467`*^9, 3.812812342364079*^9}, {
   3.813318939668003*^9, 3.8133190154283733`*^9}, {3.8133191129736648`*^9, 
   3.813319154706519*^9}, {3.8133219548640265`*^9, 3.8133219602829275`*^9}, {
   3.813322543853875*^9, 3.8133225997488956`*^9}, {3.8133235067053003`*^9, 
   3.813323559995247*^9}, 3.813324614919827*^9, {3.8133254786543007`*^9, 
   3.8133254807942705`*^9}, {3.8133256009810452`*^9, 
   3.8133256214220505`*^9}, {3.8133272788444104`*^9, 
   3.8133272793221364`*^9}, {3.8133274470341825`*^9, 
   3.8133274479956183`*^9}, {3.813327546601411*^9, 3.8133275476358175`*^9}, {
   3.813389482643263*^9, 3.813389496658246*^9}, 3.813389580985829*^9, 
   3.8133897047989283`*^9, {3.813390586501851*^9, 3.813390649158495*^9}, {
   3.8133907154968877`*^9, 3.8133907353525248`*^9}, {3.8133908982700453`*^9, 
   3.813390915061534*^9}, {3.813392975134124*^9, 3.81339299424454*^9}, 
   3.813393184787344*^9, {3.8133961474062595`*^9, 3.8133961920499163`*^9}, {
   3.8133963256661124`*^9, 3.813396340516527*^9}, {3.8133963877676287`*^9, 
   3.8133964048498583`*^9}, {3.813396459872281*^9, 3.8133964681938653`*^9}, {
   3.813396660474163*^9, 3.813396674486446*^9}, {3.813396769343224*^9, 
   3.813396773298109*^9}, {3.813396931275921*^9, 3.8133969489158573`*^9}, {
   3.813397047487932*^9, 3.8133970519143906`*^9}, {3.8133988297597337`*^9, 
   3.8133988303044233`*^9}, {3.8133993306651087`*^9, 3.813399331140836*^9}, 
   3.813399412834091*^9, {3.813399823062357*^9, 3.8133998374241424`*^9}, {
   3.813400101311749*^9, 3.813400120855853*^9}, 3.8134913858635745`*^9, {
   3.813495066458541*^9, 3.813495095330075*^9}, 3.8134952050993414`*^9, 
   3.8134952930069666`*^9, {3.813495377420248*^9, 3.8134954018902473`*^9}, {
   3.8134954768890176`*^9, 3.813495481128595*^9}, {3.8134956781914144`*^9, 
   3.813495682406455*^9}, {3.8134958333863945`*^9, 3.813495851070282*^9}, 
   3.813495949689989*^9, {3.813667618998576*^9, 3.813667681796652*^9}, {
   3.8136677328086185`*^9, 3.8136677352839394`*^9}, 3.8136684651182165`*^9, {
   3.8136686192708473`*^9, 3.8136686195736732`*^9}, {3.8136715712908974`*^9, 
   3.81367158417677*^9}},
 ExpressionUUID -> "e65dc72b-e332-4b88-bdfc-878e9a923028"],

Cell[BoxData[
 RowBox[{
  RowBox[{"systemEquationsDA", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ifc", "==", 
      RowBox[{"conNum", 
       RowBox[{"(", 
        RowBox[{"ufc1", "-", 
         RowBox[{"ufc", "/", "nstack"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"thaucon", " ", 
       RowBox[{"der", "[", "ufc1", "]"}]}], "\[Equal]", " ", 
      RowBox[{"ufc0", "-", "ufc1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"thaucon", " ", 
       RowBox[{"der", "[", "ifc0", "]"}]}], "\[Equal]", " ", 
      RowBox[{"ifc", "-", "ifc0"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.4462268279375*^9, 3.4462268990625*^9}, {
   3.446356063226486*^9, 3.4463561206800156`*^9}, {3.446356288882064*^9, 
   3.4463563806471014`*^9}, {3.4463566400204415`*^9, 
   3.4463566478641415`*^9}, {3.446356740988305*^9, 3.4463567625974035`*^9}, {
   3.446356847065072*^9, 3.446356909189277*^9}, {3.4463569505637474`*^9, 
   3.446356987860145*^9}, {3.4463570410000896`*^9, 3.446357063812298*^9}, {
   3.446379127283964*^9, 3.446379143364324*^9}, {3.446379179506104*^9, 
   3.4463792334299517`*^9}, {3.4463792634678044`*^9, 3.4463794425834913`*^9}, 
   3.446379541396244*^9, {3.446379638271485*^9, 3.4463796519105387`*^9}, {
   3.4463796846255193`*^9, 3.446379724605288*^9}, {3.4463798022994614`*^9, 
   3.4463798170008926`*^9}, {3.4463798623237963`*^9, 3.446379865823597*^9}, {
   3.4463961242555237`*^9, 3.4463961327898855`*^9}, {3.446396203550064*^9, 
   3.4463962447213287`*^9}, 3.4463963098476686`*^9, {3.4463973335728197`*^9, 
   3.446397362760133*^9}, {3.446397401369261*^9, 3.4463974497283263`*^9}, {
   3.446397489071824*^9, 3.44639769571055*^9}, {3.446397742851082*^9, 
   3.4463977445386252`*^9}, {3.4463979590128655`*^9, 
   3.4463980085141325`*^9}, {3.4463980572334223`*^9, 
   3.4463980630771723`*^9}, {3.4463981016865473`*^9, 
   3.4463981226552973`*^9}, {3.4463981943115473`*^9, 
   3.4463981991396723`*^9}, {3.4463982617334223`*^9, 3.446398369951914*^9}, {
   3.4463984402952137`*^9, 3.4463984526388845`*^9}, {3.446398517966591*^9, 
   3.4463986648560505`*^9}, {3.4463987018555765`*^9, 
   3.4463987746365695`*^9}, {3.4463988146529627`*^9, 
   3.4463990151255617`*^9}, {3.44639905628255*^9, 3.446399129798175*^9}, {
   3.446399189704425*^9, 3.446399280673175*^9}, {3.4464006876851635`*^9, 
   3.4464007123567224`*^9}, {3.4464007914182105`*^9, 
   3.4464007992306104`*^9}, {3.4464008721046777`*^9, 3.446400872620296*^9}, 
   3.4464528975154915`*^9, {3.4464634783653283`*^9, 3.4464634912715783`*^9}, {
   3.4465792743125*^9, 3.446579279671875*^9}, {3.446579491765625*^9, 
   3.446579505828125*^9}, {3.446620452265625*^9, 3.44662065565625*^9}, {
   3.446637497078125*^9, 3.4466375061875*^9}, {3.4466375385*^9, 
   3.446637551078125*^9}, {3.446637938234375*^9, 3.446637941484375*^9}, {
   3.446666699421875*^9, 3.4466667018125*^9}, {3.44666719959375*^9, 
   3.446667200734375*^9}, {3.446668322515625*^9, 3.446668332921875*^9}, {
   3.4466684914375*^9, 3.44666852496875*^9}, {3.446668996703125*^9, 
   3.446669001703125*^9}, {3.446669166515625*^9, 3.44666917659375*^9}, {
   3.44670421915625*^9, 3.4467042908125*^9}, {3.4467044806875*^9, 
   3.446704481890625*^9}, {3.446704535734375*^9, 3.446704553015625*^9}, {
   3.446704624859375*^9, 3.446704666*^9}, {3.446704786796875*^9, 
   3.446704813015625*^9}, 3.44670733509375*^9, {3.446707379109375*^9, 
   3.446707485484375*^9}, 3.446708362203125*^9, {3.44670887778125*^9, 
   3.44670891478125*^9}, {3.446741223921875*^9, 3.446741256296875*^9}, 
   3.446744558578125*^9, {3.446831900125*^9, 3.446831915421875*^9}, 
   3.447343669203125*^9, {3.4473437035*^9, 3.447343747203125*^9}, {
   3.447343851296875*^9, 3.44734385509375*^9}, {3.447343911203125*^9, 
   3.44734391234375*^9}, {3.44760895534375*^9, 3.4476091104375*^9}, {
   3.4476091595*^9, 3.44760928015625*^9}, 3.447688292375*^9, {
   3.44775987934375*^9, 3.44775990678125*^9}, {3.447938789671875*^9, 
   3.44793885996875*^9}, {3.447947536203125*^9, 3.447947793421875*^9}, {
   3.44794782525*^9, 3.447947856515625*^9}, {3.447947914734375*^9, 
   3.44794793440625*^9}, {3.447948486796875*^9, 3.447948494953125*^9}, {
   3.447950475734375*^9, 3.447950480359375*^9}, {3.4479514369375*^9, 
   3.447951552625*^9}, {3.457505719859375*^9, 3.45750590196875*^9}, {
   3.457506035859375*^9, 3.457506069921875*^9}, {3.457506159390625*^9, 
   3.45750616184375*^9}, 3.457506201890625*^9, {3.45754897903125*^9, 
   3.45754900778125*^9}, {3.5400959878200073`*^9, 3.540095995694906*^9}, {
   3.540102295915688*^9, 3.540102306962351*^9}, 3.540102359555091*^9, 
   3.5547852646756573`*^9, {3.7994924236381955`*^9, 3.799492427700014*^9}, {
   3.799492960499611*^9, 3.79949304187285*^9}, {3.799493093129093*^9, 
   3.7994930995145235`*^9}, {3.7994973393450623`*^9, 3.7994973827863503`*^9}, 
   3.7994975405919204`*^9, {3.7995527757880373`*^9, 3.79955292047711*^9}, {
   3.7995531753457747`*^9, 3.799553190898768*^9}, {3.7995533685758853`*^9, 
   3.799553374294998*^9}, {3.7995538287012825`*^9, 3.799553981267248*^9}, {
   3.799554016508975*^9, 3.79955406649852*^9}, {3.7995546336108*^9, 
   3.7995546365757446`*^9}, {3.7995552748414173`*^9, 
   3.7995552865553603`*^9}, {3.7995558687621*^9, 3.7995558940900307`*^9}, {
   3.7995560230472956`*^9, 3.79955602914402*^9}, {3.79955616631783*^9, 
   3.7995561891523256`*^9}, {3.799556439933199*^9, 3.799556441921152*^9}, {
   3.7995571433419914`*^9, 3.799557154322686*^9}, 3.7995572102281427`*^9, {
   3.7995574284155645`*^9, 3.7995574309589467`*^9}, {3.7995634239853935`*^9, 
   3.7995634775372744`*^9}, {3.7995635940363603`*^9, 
   3.7995635952770824`*^9}, {3.799563626504943*^9, 3.7995636266567855`*^9}, {
   3.7995637831407175`*^9, 3.799563790699936*^9}, {3.800002562092661*^9, 
   3.8000026991983824`*^9}, {3.800002875613695*^9, 3.800002877341915*^9}, {
   3.800003010400816*^9, 3.8000030660864334`*^9}, {3.8000031175177183`*^9, 
   3.800003123028039*^9}, {3.8000109590668335`*^9, 3.8000109670965605`*^9}, {
   3.800011314647444*^9, 3.8000113361412964`*^9}, {3.8000116639554944`*^9, 
   3.8000116906230145`*^9}, {3.8000117440359783`*^9, 
   3.8000117602412777`*^9}, {3.8000128225376835`*^9, 3.800012823976201*^9}, {
   3.80001361188822*^9, 3.8000136153037004`*^9}, {3.8000137465714407`*^9, 
   3.800013747826148*^9}, {3.800073474108486*^9, 3.800073476876728*^9}, 
   3.800073516068714*^9, 3.800082029744317*^9, {3.8000824895735073`*^9, 
   3.800082521851248*^9}, {3.8000826839022713`*^9, 3.8000826942985573`*^9}, 
   3.8000831800160728`*^9, {3.8000906704540462`*^9, 3.8000906779643087`*^9}, 
   3.800096224068581*^9, {3.8000964106952796`*^9, 3.80009643932478*^9}, 
   3.8000982689301715`*^9, 3.800098363992219*^9, {3.800098514083564*^9, 
   3.8000985322798157`*^9}, {3.800100835590475*^9, 3.8001008379670267`*^9}, {
   3.8001019879490805`*^9, 3.8001019995021763`*^9}, {3.800115756657752*^9, 
   3.8001157594558697`*^9}, {3.8079583634533453`*^9, 3.807958434795323*^9}, {
   3.807958470598457*^9, 3.8079585038530474`*^9}, {3.8079585565141935`*^9, 
   3.8079585878472853`*^9}, {3.8079587081327357`*^9, 3.807958709557109*^9}, {
   3.8079593221263447`*^9, 3.807959354351246*^9}, {3.807959399917013*^9, 
   3.807959404111781*^9}, 3.80795946198814*^9, {3.8079596886274767`*^9, 
   3.8079596905223866`*^9}, {3.8079597343249497`*^9, 3.807959792584378*^9}, {
   3.8079609786834593`*^9, 3.807960995351041*^9}, {3.8079638261387534`*^9, 
   3.807963869798442*^9}, {3.807965169546875*^9, 3.8079652019419317`*^9}, {
   3.807965315236332*^9, 3.807965339888794*^9}, {3.8079653832064023`*^9, 
   3.8079653900625687`*^9}, 3.8079655585948234`*^9, {3.812101242622156*^9, 
   3.8121012506565437`*^9}, {3.812101313235817*^9, 3.8121014302355585`*^9}, {
   3.812101462934265*^9, 3.812101466990885*^9}, 3.8121015128408713`*^9, {
   3.812101560657725*^9, 3.812101571143826*^9}, 3.8122812797774696`*^9, {
   3.8122814615148993`*^9, 3.812281551953337*^9}, {3.8122815899004*^9, 
   3.8122816608961725`*^9}, {3.8122818851889853`*^9, 
   3.8122819130868783`*^9}, {3.8124459771916127`*^9, 
   3.8124460087521515`*^9}, {3.8124463506061945`*^9, 3.81244635701758*^9}, {
   3.8127968168782663`*^9, 3.8127968207417107`*^9}, 3.812806232177376*^9, {
   3.8128078490219164`*^9, 3.8128079279498234`*^9}, {3.8128079608294973`*^9, 
   3.812807972701564*^9}, 3.812808746928312*^9, {3.8128089278299007`*^9, 
   3.8128089300206056`*^9}, 3.813323798026724*^9, {3.813323834069107*^9, 
   3.8133239040460377`*^9}, {3.813323958522871*^9, 3.81332401417981*^9}, {
   3.813324103266342*^9, 3.8133241465474353`*^9}, {3.8133247505006323`*^9, 
   3.8133247816891108`*^9}, 3.8133250734430213`*^9, {3.813390694328988*^9, 
   3.813390697765024*^9}, {3.8136677933965464`*^9, 3.8136677936823997`*^9}, {
   3.8136681045116587`*^9, 3.813668107677844*^9}},
 ExpressionUUID -> "304e89b4-d65d-40b0-9495-de9f4f7b46de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"systemBoundaryEquations", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"ufc", "==", " ", 
      RowBox[{"cfc", "+", 
       RowBox[{"Zcfc", " ", "ifc"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pp1", " ", "==", " ", 
      RowBox[{"(", 
       RowBox[{"cp1", " ", "+", " ", 
        RowBox[{"Zcp1", " ", "dEp1"}]}], " ", ")"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.5400959186490173`*^9, 3.5400959186490173`*^9}, {
   3.8000025140951138`*^9, 3.800002537289214*^9}, 3.8000149959382753`*^9, {
   3.8079638964252844`*^9, 3.8079638976946807`*^9}, 3.8122833260144963`*^9, {
   3.8124457458946986`*^9, 3.8124457550554314`*^9}, {3.8124457968143225`*^9, 
   3.812445797097587*^9}, 3.8124460540797205`*^9, 3.8136702289567533`*^9, {
   3.813674295847139*^9, 3.813674339547169*^9}, 
   3.8136744212413263`*^9},ExpressionUUID->"0ea1cdea-96b3-4906-9c53-\
9ab5dc2446b2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"systemVariables", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"ifc", ",", "ufc1", ",", "ifc0", ",", "ufc", ",", "pp1"}], 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.540095912227225*^9, 3.5400959122428493`*^9}, {
   3.7995539904028444`*^9, 3.7995540055382657`*^9}, {3.7995552889548903`*^9, 
   3.799555292747988*^9}, 3.799555638858739*^9, 3.799555707290303*^9, {
   3.799555821461788*^9, 3.7995558277113533`*^9}, 3.799556192038355*^9, 
   3.799557139930501*^9, {3.7995571784238787`*^9, 3.7995571814637504`*^9}, 
   3.7995635147479715`*^9, 3.799563601251933*^9, {3.800002808045322*^9, 
   3.800002842484833*^9}, {3.8000030747205367`*^9, 3.8000030804036937`*^9}, 
   3.800010707364189*^9, {3.800014193019421*^9, 3.800014198657611*^9}, {
   3.800014240013996*^9, 3.8000142430428762`*^9}, 3.8000142997204776`*^9, {
   3.8000147279124503`*^9, 3.8000147348053474`*^9}, 3.800082069896945*^9, 
   3.8000983866958265`*^9, 3.80010199706269*^9, {3.8001157685964537`*^9, 
   3.8001157690879436`*^9}, {3.807963885567665*^9, 3.807963902790323*^9}, 
   3.8122814336057744`*^9, {3.8122834031373463`*^9, 3.8122834121481905`*^9}, {
   3.812445759144534*^9, 3.8124457645178404`*^9}, {3.8128082692988596`*^9, 
   3.812808274785383*^9}, {3.8128083371143446`*^9, 3.8128083437863865`*^9}, 
   3.8128089476130943`*^9, {3.813324060590757*^9, 3.813324070177273*^9}, {
   3.81332439313008*^9, 3.813324394564238*^9}, {3.813670232939475*^9, 
   3.8136702341187997`*^9}},
 ExpressionUUID -> "d964da04-67d5-489e-b529-2f3f4626dc9a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"expressions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"etaFC", "\[Equal]", 
      RowBox[{"ufc", "/", 
       RowBox[{"(", 
        RowBox[{"nstack", " ", "unernst"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Powfc", "==", 
      RowBox[{"ufc", " ", "ifc"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"WH2", "==", 
      RowBox[{"MH2", 
       FractionBox[
        RowBox[{"nstack", " ", "ifc"}], 
        RowBox[{"2", " ", "Faraday"}]]}]}], ",", " ", "\[IndentingNewLine]", 
     RowBox[{"qmp1", "\[Equal]", 
      RowBox[{
       RowBox[{"-", "MH2"}], 
       FractionBox[
        RowBox[{"nstack", " ", "ifc"}], 
        RowBox[{"2", " ", "Faraday"}]]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"dEp1", "\[Equal]", 
      RowBox[{"qmp1", " ", "cp", " ", "Tp1"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"mFC", "\[Equal]", 
      RowBox[{"nstack", " ", "unernst", " ", "Jmax", " ", 
       RowBox[{"A", "/", "kmFC"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.8000132252026625`*^9, 3.8000132497663517`*^9}, {
   3.800013601216216*^9, 3.800013606995268*^9}, {3.8000830821349316`*^9, 
   3.8000831104008045`*^9}, {3.8000983668732505`*^9, 3.800098367187927*^9}, {
   3.8001019921977034`*^9, 3.8001019924524403`*^9}, {3.8001035772095027`*^9, 
   3.8001036256625757`*^9}, {3.8001036973816757`*^9, 3.800103697782262*^9}, 
   3.8001157525829525`*^9, 3.807963722614456*^9, 3.8079639166015654`*^9, {
   3.8124440918919525`*^9, 3.8124441300574727`*^9}, {3.8124441947084146`*^9, 
   3.812444211708972*^9}, {3.8124464152015347`*^9, 3.812446421235523*^9}, {
   3.8124493608532267`*^9, 3.8124493617506485`*^9}, {3.813667829512759*^9, 
   3.813667837029454*^9}, {3.8136678907087564`*^9, 3.813667902518628*^9}, {
   3.8136681201487103`*^9, 3.8136681222135277`*^9}, {3.8136683417333164`*^9, 
   3.8136683516746283`*^9}, {3.813668480682209*^9, 3.8136684823362627`*^9}, {
   3.8136685391892624`*^9, 3.8136685395170774`*^9}, {3.8136702804101934`*^9, 
   3.8136702837792673`*^9}, 3.8136703144611406`*^9, {3.8136713112230434`*^9, 
   3.813671343990834*^9}, {3.81367149584777*^9, 3.8136715420095463`*^9}, 
   3.8136725269530916`*^9, {3.813674424395522*^9, 
   3.813674436710475*^9}},ExpressionUUID->"36d453ee-02cf-4096-955f-\
e3fc9864a3a7"],

Cell[BoxData[
 RowBox[{"Compgen", "[", "file", "]"}]], "Input",
 ExpressionUUID -> "e5ab3ee3-7974-44ec-9704-74611d7b2f4e"]
}, Open  ]]
},
WindowSize->{932, 698},
WindowMargins->{{Automatic, -1564}, {-4, Automatic}},
PrintingCopies->1,
PrintingPageRange->{32000, 32000},
PrintingOptions->{"Magnification"->1.,
"PaperOrientation"->"Portrait",
"PaperSize"->{595.3199999999999, 841.92}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.0 for Microsoft Windows (64-bit) (September 21, 2016)",
StyleDefinitions->FrontEnd`FileName[{"Report"}, "StandardReport.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID -> "ab22c945-d957-449a-aac9-c99a8ee1d8bd"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 288, 4, 109, "Title"],
Cell[870, 28, 988, 18, 256, "Text"],
Cell[CellGroupData[{
Cell[1883, 50, 355, 6, 43, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}],
Cell[2241, 58, 1241, 21, 66, "Input",
 CellGroupingRules->{"GroupTogetherGrouping", 10000.}]
}, Open  ]],
Cell[3497, 82, 2314, 32, 43, "Output"],
Cell[5814, 116, 183, 4, 43, "Input"],
Cell[6000, 122, 1757, 38, 198, "Input"],
Cell[7760, 162, 1855, 30, 88, "Input"],
Cell[9618, 194, 10111, 202, 749, "Input"],
Cell[19732, 398, 4604, 90, 352, "Input"],
Cell[24339, 490, 646, 14, 110, "Input"],
Cell[24988, 506, 379, 11, 68, "Input"],
Cell[25370, 519, 198, 4, 43, "Input"],
Cell[25571, 525, 220, 5, 43, "Input"],
Cell[25794, 532, 96, 1, 43, "Input"],
Cell[25893, 535, 298, 5, 53, "Text"],
Cell[26194, 542, 7861, 169, 539, "Input"],
Cell[34058, 713, 8902, 134, 132, "Input"],
Cell[42963, 849, 977, 20, 110, "Input"],
Cell[43943, 871, 1567, 24, 66, "Input"],
Cell[45513, 897, 2353, 46, 274, "Input"],
Cell[47869, 945, 122, 2, 43, "Input"]
}, Open  ]]
}
]
*)

